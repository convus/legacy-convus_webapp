%h1
  Viewing Citation

.max-main-width
  - if @citation.unapproved?
    .alert.alert-info
      - if @citation.pull_request_number.present?
        %h4
          Citation waiting on approval,
          = link_to "PR#{@citation.pull_request_number}", @citation.pull_request_url
      - else
        Waiting for pull request to be created, page will reload.
        -# NOTE: This will reload endlessly, which may not be what we want
        :javascript
          window.setTimeout(() => {location.reload();}, 1000);

  %table.table-list
    %tbody
      %tr
        %td Title
        %td= @citation.title
      %tr
        %td GitHub
        %td
          - if @citation.approved?
            = link_to UrlCleaner.pretty_url(@citation.github_html_url), @citation.github_html_url
            - if @citation.pull_request_number.present?
              %br
              Approved by
              = link_to "PR#{@citation.pull_request_number}", @citation.pull_request_url
      %tr
        %td ID
        %td= @citation.id
      %tr
        %td URL
        %td
          = link_to @citation.file_path, @citation.url
      %tr.small
        %td URL direct link?
        %td= @citation.url_is_direct_link_to_full_text
      %tr
        %td Publication
        %td
          - if @citation.publication.present?
            = link_to @citation.publication.title, publication_path(@citation.publication)
      %tr
        %td Kind
        %td= @citation.kind_humanized
      %tr
        %td Published date
        %td
          -# See note about time specificity in citation - it's why we're doing date, not convertTime
          = @citation.published_date_str
      %tr
        %td Authors
        %td
          - if @citation.authors.present?
            %ul
              - @citation.authors.each do |author|
                %li
                  = author
      %tr
        %td Hypotheses
        %td= @hypotheses.count

%h2.mt-4.mb-1 Hypotheses

= render partial: "/hypotheses/table", locals: { citations: @hypotheses, skip_citation_id: @citation.id }
