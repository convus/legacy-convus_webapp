- is_edit ||= false
- render_preview = @argument.id.present? && @argument.body_html.present?

.small-page-header
  %h1
    %span.d-none.d-md-block
      Hypothesis:
.row
  = render partial: "/hypotheses/show_title", locals: {hypothesis: @hypothesis, render_show_link: true}

- form_submit_path = is_edit ? hypothesis_argument_path(hypothesis_id: @hypothesis, id: @argument.id) : hypothesis_arguments_path(hypothesis_id: @hypothesis)
= form_for @argument, url: form_submit_path, method: (is_edit ? "PATCH" : "POST"), html: {class: "form", id: "argumentForm"} do |f|
  = f.hidden_field :add_to_github, class: "addToGithubField"

  - if @argument.id.blank?
    -# Initially assign something to demonstrate how to make quotes
    - @argument.text ||= "Make your argument here\n\n> This is an example quote"

  .row
    - if @argument.errors.any?
      .col-md-6.mb-4.mt-2
        = render partial: "/shared/errors", locals: {name: "Argument", obj: @argument}

  .row.mt-4
    .max-width-text-container.col
      .form-group.mb-0
        = f.label :text do
          %span.argument-text-label{ title: "Renders with markdown, except no images, links or html" }
            - if is_edit
              Edit new argument:
            - else
              Create argument:
        = f.text_area :text, rows: 10, class: "form-control"
  #quoteFieldsWrapper
    #quoteFields.row
      - @argument.argument_quotes.not_removed.ref_ordered.each do |argument_quote|
        = render partial: "/hypothesis_arguments/argument_quote", locals: {argument_quote: argument_quote}

    #quoteFieldsRemoved.removed-quotes.row.collapse{class: (@argument.argument_quotes.removed.any? ? "show" : "")}
      .col-12.text-warning
        %h4 Removed quotes
      - @argument.argument_quotes.removed.ref_ordered.each do |argument_quote|
        = render partial: "/hypothesis_arguments/argument_quote", locals: {argument_quote: argument_quote}
  - if render_preview
    #argumentPreview.row.collapse{class: (render_preview ? "show" : "")}
      = render partial: "/hypothesis_arguments/show", locals: {argument: @argument, preview: true, skip_edit: true}
  .row.pt-4.mt-5
    .col
      .form-group
        = submit_tag "Save", class: "btn btn-primary"
        %em#saveToPreview.ml-2.less-strong.collapse{class: (render_preview ? "" : "show")}
          \... to preview

      - if is_edit
        .mt-4
          %a#submitForApproval.btn.btn-success.submit-input{ href: "#" }
            Submit for Approval
            %span.loadingSpinner.spinner-border.spinner-border-sm.collapse.ml-2
              %span.sr-only Loading...
          %em#quoteRequired.collapse.less-strong
            Arguments must include at least one block quote to submit (start line with <code>></code>)


%hr
%h2.mt-4
  - if @hypothesis_citations_shown.count == 0
    No Existing
  citations:
.row
  - @hypothesis_citations_shown.each do |hypothesis_citation|
    = render partial: "/hypotheses/show_hypothesis_citation", locals: {hypothesis_citation: hypothesis_citation, skip_challenge: true}

.mt-big
= render "/shared/content_license"
